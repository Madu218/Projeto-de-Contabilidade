<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./style.css" />
    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>
    <title>Projeto de Contabilidade</title>
</head>

<body>
    <header>
        <h2 class="h2-header">Contabilidade de Custos e Gerencial</h2>
        <h4 class="h4-header">Insira no input abaixo o município do qual deseja obter informações:</h4>
        <input type="text" class="input-header" id="input_municipio" placeholder="Digite aqui o município...">
        <input type="text" class="input-header" id="input_estado" placeholder="Digite aqui a sigla do estado...">
        <button type="submit" class="button-header" id="button_municipio" py-click="visualizar_tabela()">Visualizar
            tabela</button>
    </header>

    <main id="main">

    </main>

    <footer>
        <h4>
            Projeto desenvolvido por <a class="a-footer" href="https://github.com/geovannaadomingos"
                target="_blank">Geovanna
                Domingos</a>,
            <a class="a-footer" href="https://github.com/gustavo-ghcs" target="_blank">Gustavo de Hollanda</a>, <a
                class="a-footer" href="https://github.com/higorcunha1" target="_blank">Higor Cunha</a>, <a
                class="a-footer" href="https://github.com/Madu2018" target="_blank">Maria Eduarda</a> e <a
                class="a-footer" href="https://github.com/PedroSouza157998" target="_blank">Pedro Souza</a>.
        </h4>
    </footer>
    <py-script>
        import openpyxl
        from pyscript import document, Element

        def visualizar_tabela():
            # Ler o arquivo xlsx
            wb = openpyxl.load_workbook("TabelaFinal.xlsx")
            ws = wb.active
            
            # Criar uma tabela HTML
            table = document.createElement("table")
            
            # Adicionar as linhas da tabela xlsx na tabela HTML
            for row in ws.iter_rows(values_only=True):
                tr = document.createElement("tr")
                for value in row:
                    td = document.createElement("td")
                    td.textContent = str(value)
                    tr.appendChild(td)
                table.appendChild(tr)

            # Adicionar a tabela HTML na tag main do html
            main = Element("main")
            main.appendChild(table)
    </py-script>
</body>

</html>